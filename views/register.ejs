<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    </head>
    <body>
        <nav class="navbar navbar-dark" style="background-color: rgb(94, 0, 183);">
            <span class="navbar-brand mb-0 p-12 h1" style="padding: 30px;text-align: center;">INTERPERSONAL PSYCHIATRY</span>
        </nav>
        <form style="padding-left: 200px;padding-right: 200px; padding-top:100px" >
            <label class ="text-success" id="success" for="exampleInputEmail1" style="padding-bottom: 10px; visibility: hidden;" value="">User Registered Successfully</label>
            <label class="text-danger" id="error" for="exampleInputEmail1" style="padding-bottom: 5px; visibility: hidden;"
                value="">Something went wrong !! please try again</label>
            <div class="form-group">
                <label for="exampleInputEmail1" style="padding-bottom: 5px;">Username</label>
                <input class="form-control" id ="uname" type="text" value="" readonly>
            </div>
            <div class="form-group" style="padding-top:25px; padding-bottom: 20px">
                <label for="exampleInputPassword1"  style="padding-bottom: 5px;">Password</label>
                <input type="password" class="form-control"  id="pword" placeholder="Password">
            </div>
            <button type="button" class="btn btn-primary" onclick="handleSubmit()">Submit</button>   
        </form>

        <script>
            const username = document.getElementById('uname')
            username.value = "<%= user.userName %>"
            async function handleSubmit(){
                const uname = document.getElementById('uname')
                const pword = document.getElementById('pword')
                const payload = {
                    userName: uname.value,
                    password: pword.value
                };
                const formData = JSON.stringify(payload)
                console.log(formData)
                fetch("<%= resetEndPoint %>",{
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: formData
                })
                .then(response => {
                    const data = response.json()
                    const successMsg = document.getElementById("success")
                    successMsg.style.visibility = "visible"
                    const pword = document.getElementById('pword')
                    pword.setAttribute("readonly","readonly")
                })
                .catch(response=>{
                    const errorMsg = document.getElementById("error")
                    errorMsg.class = "text-danger"
                    errorMsg.value = "Sorry, Something went wrong !! Try again."
                })
                
            }
        </script>


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous">
        </script>
    </body>
</html>
